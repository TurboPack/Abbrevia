<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
 <HEAD>
  <!-- $MVD$:app("RoboHELP HTML Edition by Blue Sky Software, portions by MicroVision Dev. Inc.","769") -->
  <!-- $MVD$:template("","0","0") -->
  <!-- $MVD$:fontset("Symbol","Symbol") -->
  <TITLE>TAbZipArchive.OnNeedPassword</TITLE>
  <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=Windows-1252">
  <SCRIPT LANGUAGE="javascript" TITLE="BSSC Special Effects" SRC="BSSCDHTM.js">
</SCRIPT>
 <META NAME="generator" CONTENT="RoboHELP by Blue Sky Software www.blue-sky.com HTML Edition">
 <META NAME="MS-HKWD" CONTENT="OnNeedPassword:TAbZipArchive">
 <META NAME="MS-HKWD" CONTENT="OnNeedPassword"></HEAD>
  <BODY BGCOLOR="WHITE" TEXT="BLACK" ONLOAD="BSSCOnLoad();" ONCLICK="BSSCOnClick();" ONUNLOAD="BSSCOnUnload();">
  <H1>
   TAbZipArchive.OnNeedPassword</H1>
  <P>
   <A HREF="ch100uat.htm">TAbZipArchive</A></P><PRE><CODE><B>property</B> OnNeedPassword : TAbNeedPasswordEvent</CODE><BR><CODE>TAbNeedPasswordEvent = <B>procedure</B>(</CODE><BR><CODE>  Sender : TObject; <B>var</B> NewPassword : <B>string</B>) <B>of object</B>;</CODE></PRE><P>
   Defines an event handler that is called to allow entry of a password 
   when decrypting a file.</P>
  <P>
   The OnNeedPassword event handler is called when an encrypted file is 
   being extracted and one of the following occurs:</P>
  <P>
   <FONT FACE="Symbol">&#183;</FONT>The Password property is empty.</P>
  <P>
   <FONT FACE="Symbol">&#183;</FONT>The Password is not valid for the 
   encrypted file and the number of attempts is less than PasswordRetries.</P>
  <P>
   The event does not change the value of the Password property.</P>
  <P>
   The following example displays the password dialog that is included 
   in the AbDlgPwd unit. It allows the user to enter a new password.</P><PRE><CODE><B>uses</B></CODE><BR><CODE>  AbDlgPwd;</CODE><BR><CODE><B>procedure</B> TForm1.AbZipArchive1NeedPassword(</CODE><BR><CODE>  Sender : TObject; <B>var</B> NewPassword : <B>string</B>);</CODE><BR><CODE><B>var</B></CODE><BR><CODE>  Dlg : TPassWordDlg;</CODE><BR><CODE><B>begin</B></CODE><BR><CODE>  <B>with</B> TPassWordDlg.Create(Application) <B>do</B> <B>begin</B></CODE><BR><CODE>    <B>try</B></CODE><BR><CODE>      <B>if</B> (ShowModal = mrOK) <B>then</B></CODE><BR><CODE>        NewPassword := Edit1.Text;</CODE><BR><CODE>    <B>finally</B></CODE><BR><CODE>      Free;</CODE><BR><CODE>    <B>end</B>;</CODE><BR><CODE>  <B>end</B>;</CODE><BR><CODE><B>end</B>;</CODE></PRE><P>
   See also: <A HREF="ch108f38.htm">Password</A>, <A HREF="ch102k6r.htm">PasswordRetries</A>
 </BODY>
</HTML>